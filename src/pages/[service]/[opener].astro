---
export const prerender = true;
import "../../styles/global.css";
// 1. Astro Content Collection Imports
// This API efficiently reads all your Markdown files at build time
import { getCollection } from "astro:content";
import { type CollectionEntry } from "astro:content";
// 1. Imports
import Layout from "../../layouts/Layout.astro"; // Adjust path based on your folder depth
import UtilityNav from "../../components/UtilityNav.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import Sidebar from "../../components/Sidebar.astro";
import OpenerView from "../../components/OpenerView.astro";

// Define the Content Collection type for clarity
type ServicePageEntry = CollectionEntry<"openers">;

// 3. getStaticPaths: Defines ALL the URLs to be built
export async function getStaticPaths() {
    // 3.1 Fetch ALL content from the 'service-areas' collection
    const servicePages = await getCollection("openers");

    // 3.2 Map the content to the dynamic URL structure
    return servicePages.map((page: ServicePageEntry) => ({
        params: {
            // These params define the URL segments: /service-slug/city-slug
            opener: page.id, // e.g., 'opener-service'
            service: "garage-door-opener",
        },
        props: {
            page, // Pass the entire page object (content and data) to the component
        },
    }));
}

// 4. Data Fetching and Destructuring (Runs at build time)
const { page } = Astro.props as { page: ServicePageEntry };

// Render the Markdown content into an Astro component (runs once at build time)
// const { Content } = await page.render();

// Destructure the SEO metadata from the Frontmatter (page.data)
const { model, description, brand, name } = page.data;
const title = `${brand} ${model}`;
// Set the Canonical URL for SEO consistency
// const canonicalURL = `https://yorkgaragepros.com/${page.data.service}/${page.data.city}`;
---

<Layout title={title} description={description}>
    <UtilityNav />
    <Header />

    <!-- <link rel="canonical" href={canonicalURL} /> -->

    <section class="service-page">
        <div class="service-container">
            <h1 class="service-title">
                {title}
            </h1>

            <p class="service-intro">
                {name}
            </p>
            <section class="content-grid">
                <div class="main-column">
                    <div class="content-card">
                        <OpenerView opener={page.data} />
                    </div>
                </div>

                <!-- Sidebar -->
                <aside class="sidebar">
                    <Sidebar serviceSlug="garage-door-opener" citySlug={""} />
                </aside>
            </section>
        </div>
    </section>

    <Footer />
</Layout>
<style>
    /* ===============================
   Variables
================================ */
    :root {
        --navy-darkest: #0f1f33;
        --navy: #1c2a44;
        --gold: #e8a900;
        --gray-50: #f9fafb;
        --gray-200: #e5e7eb;
        --gray-700: #374151;
        --white: #ffffff;
    }

    /* ===============================
   Layout
================================ */
    .service-page {
        padding: 40px 16px;
        background: #fff;
    }

    .service-container {
        max-width: 1280px;
        margin: 0 auto;
    }

    /* ===============================
   Headings & Intro
================================ */
    .service-title {
        font-size: 2.25rem;

        font-family: "Montserrat-ExtraBold", "Inter", sans-serif;
        color: var(--navy-darkest);
        border-bottom: 4px solid var(--gold);
        padding-bottom: 12px;
        margin-bottom: 24px;
    }

    .service-intro {
        font-size: 1.25rem;
        color: var(--gray-700);
        border-left: 4px solid var(--gold);
        padding-left: 12px;
        font-style: italic;
        margin-bottom: 40px;
    }

    /* ========== Sidebar ========== */
    .sidebar {
        position: relative;
    }

    @media (min-width: 1024px) {
        .sidebar {
            position: sticky;
            top: 2rem;
        }
    }

    /* ===============================
   Responsive
================================ */
    @media (min-width: 1024px) {
        .service-page {
            padding: 64px 24px;
        }
    }
    /* ===============================
       Layout
    ================================ */
    .content-grid {
        max-width: 1200px;
        margin: 0 auto;
        padding: 16px; /* Reduced for mobile */
        display: grid;
        grid-template-columns: 1fr; /* Stack everything on mobile */
        gap: 24px;
    }

    /* Only go to side-by-side on large tablets and desktops */
    @media (min-width: 1024px) {
        .content-grid {
            grid-template-columns: 2fr 1fr;
            padding: 64px 24px;
            gap: 40px;
        }
    }

    .main-column {
        display: flex;
        flex-direction: column;
        gap: 32px;
        width: 100%; /* Ensure it takes full width on mobile */
    }

    /* ===============================
       Content Card
    ================================ */
    .content-card {
        background: var(--white);
        padding: 16px; /* Tighter padding on mobile */
        border-radius: 12px;
        box-shadow: var(--shadow);
        border: 1px solid #e5e7eb;
    }

    @media (min-width: 768px) {
        .content-card {
            padding: 32px; /* Breathable padding for desktop */
        }
    }
</style>
