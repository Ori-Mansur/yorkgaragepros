---
/* No imports â€” fully client-side */
---

<section id="estimator" class="estimator-section">
    <div class="estimator-container">
        <h2 class="estimator-title">Project Estimator</h2>
        <p class="estimator-subtitle">
            Configure your needs to get a rough project range estimate.
        </p>

        <!-- Estimator Card -->
        <div class="estimator-card">
            <form id="estimatorForm" class="estimator-form">
                <!-- Garage Size -->
                <section class="form-container">
                    <div>
                        <div class="form-group">
                            <label for="garageSizeEst" class="form-label"
                                >Garage Size</label
                            >
                            <select id="garageSizeEst" class="form-select">
                                <option value="2"
                                    >2 Car (Standard Double)</option
                                >
                                <option value="1">1 Car (Single Door)</option>
                                <option value="3">3+ Car / Custom</option>
                            </select>
                        </div>

                        <!-- Services -->
                        <div class="form-group">
                            <label class="form-label">Services Needed</label>

                            <div class="checkbox-row">
                                <input
                                    id="doorService"
                                    type="checkbox"
                                    checked
                                    class="checkbox"
                                />
                                <label for="doorService" class="checkbox-label"
                                    >Door Installation (Standard Steel)</label
                                >
                            </div>

                            <div class="checkbox-row">
                                <input
                                    id="openerService"
                                    type="checkbox"
                                    class="checkbox"
                                />
                                <label
                                    for="openerService"
                                    class="checkbox-label"
                                    >Opener Installation/Replacement</label
                                >
                            </div>

                            <div class="checkbox-row">
                                <input
                                    id="epoxyService"
                                    type="checkbox"
                                    class="checkbox"
                                />
                                <label for="epoxyService" class="checkbox-label"
                                    >Epoxy Floor Coating</label
                                >
                            </div>

                            <div class="checkbox-row">
                                <input
                                    id="repairService"
                                    type="checkbox"
                                    class="checkbox"
                                />
                                <label
                                    for="repairService"
                                    class="checkbox-label"
                                    >Emergency Repair (Springs, Cables, etc.)</label
                                >
                            </div>
                        </div>
                    </div>
                    <!-- Estimated Range -->
                    <div class="estimate-box">
                        <h3 class="estimate-label">ESTIMATED RANGE</h3>
                        <p id="priceRange" class="estimate-price">$0 - $0</p>
                        <p id="timeRange" class="estimate-time">
                            Project Duration: 0 Days
                        </p>
                        <p class="estimate-note">
                            *Range is highly variable. Select services for an
                            instant estimate.
                        </p>
                    </div>
                </section>
                <a href="/booking">
                    <button type="button" class="cta-button">
                        SCHEDULE OFFICIAL CONSULTATION
                    </button>
                </a>
            </form>
        </div>
    </div>
</section>

<script is:inline>
    // --- Pricing Constants ---
    const PRICING = {
        door: { base: 1800, minMultiplier: 1.0, maxMultiplier: 1.5, days: 1 },
        opener: {
            base: 600,
            minMultiplier: 1.0,
            maxMultiplier: 1.6,
            days: 0.5,
        },
        epoxy: { base: 1500, minMultiplier: 1.0, maxMultiplier: 2.0, days: 2 },
        repair: {
            base: 350,
            minMultiplier: 1.0,
            maxMultiplier: 2.5,
            days: 0.5,
        },
    };

    function calculateEstimate() {
        // Elements
        const sizeSelect = document.getElementById("garageSizeEst");
        const doorChecked = document.getElementById("doorService");
        const openerChecked = document.getElementById("openerService");
        const epoxyChecked = document.getElementById("epoxyService");
        const repairChecked = document.getElementById("repairService");

        if (!sizeSelect || !doorChecked) return; // Safety check

        const size = parseFloat(sizeSelect.value);
        let minPrice = 0;
        let maxPrice = 0;
        let totalDays = 0;

        if (doorChecked.checked) {
            minPrice += PRICING.door.base * PRICING.door.minMultiplier * size;
            maxPrice += PRICING.door.base * PRICING.door.maxMultiplier * size;
            totalDays += PRICING.door.days;
        }
        if (openerChecked.checked) {
            minPrice +=
                PRICING.opener.base * PRICING.opener.minMultiplier * size;
            maxPrice +=
                PRICING.opener.base * PRICING.opener.maxMultiplier * size;
            totalDays += PRICING.opener.days;
        }
        if (epoxyChecked.checked) {
            minPrice += PRICING.epoxy.base * PRICING.epoxy.minMultiplier * size;
            maxPrice += PRICING.epoxy.base * PRICING.epoxy.maxMultiplier * size;
            totalDays += PRICING.epoxy.days;
        }
        if (repairChecked.checked) {
            minPrice += PRICING.repair.base * PRICING.repair.minMultiplier;
            maxPrice += PRICING.repair.base * PRICING.repair.maxMultiplier;
            totalDays += PRICING.repair.days;
        }

        const priceRangeElement = document.getElementById("priceRange");
        const timeRangeElement = document.getElementById("timeRange");

        if (minPrice === 0) {
            priceRangeElement.textContent = "$0 - $0";
            timeRangeElement.textContent = "Project Duration: 0 Days";
        } else {
            // Safari-safe currency formatting
            const format = (num) =>
                "$" + Math.round(num).toLocaleString("en-US");

            priceRangeElement.textContent = `${format(minPrice)} - ${format(maxPrice)}`;

            let timeText =
                totalDays < 1
                    ? "Less than 1 Day"
                    : `${totalDays} Day${totalDays > 1 ? "s" : ""}`;
            timeRangeElement.textContent = `Project Duration: ${timeText}`;
        }
    }

    // iPhone-optimized event listeners
    function initEstimator() {
        const form = document.getElementById("estimatorForm");
        if (form) {
            // 'input' is better for iPhone than 'change'
            form.addEventListener("input", calculateEstimate);
            form.addEventListener("change", calculateEstimate);
        }
        calculateEstimate();
    }

    // Fire immediately and on load
    if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initEstimator);
    } else {
        initEstimator();
    }
</script>
<style>
    /* ===============================
   COLOR PALETTE
=============================== */

    /* Branding */
    :root {
        /* --brand-navy: #172a4e; */
        --brand-navy: #1c2a44;
        --brand-gold: #e8a900;
        --sec-bg: #f3f4f6;
    }
    * {
        box-sizing: border-box;
    }
    input,
    label {
        cursor: pointer;
    }

    /* Section */
    .estimator-section {
        background: var(--sec-bg);
        padding: 4rem 0;
    }

    @media (min-width: 768px) {
        .estimator-section {
            padding: 6rem 0;
        }
    }

    /* Container */
    .estimator-container {
        max-width: 1120px;
        margin: 0 auto;
        text-align: center;
        padding: 0 1.5rem;
    }

    /* Headers */
    .estimator-title {
        font-size: 2rem;
        margin-bottom: 1rem;
        color: var(--primary-color);
        font-family: "Montserrat-ExtraBold", "Inter", sans-serif;
    }
    .form-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
    }

    @media (min-width: 768px) {
        .estimator-title {
            font-size: 2.5rem;
        }
    }

    .estimator-subtitle {
        color: var(--text-color);
        max-width: 600px;
        margin: 0 auto 2.5rem;
    }

    /* Card */
    .estimator-card {
        background: white;
        padding: 2rem;
        border-radius: 14px;
        /* max-width: 480px; */
        margin: 0 auto;
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
    }

    @media (min-width: 640px) {
        .estimator-card {
            padding: 2.5rem;
        }
    }

    .estimator-form {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
        text-align: left;
    }

    /* Form elements */
    .form-label {
        display: block;
        font-size: 0.9rem;
        font-family: "Montserrat-ExtraBold", "Inter", sans-serif;
        margin-bottom: 0.3rem;
        color: #4b5563;
    }

    .form-select {
        width: 100%;
        padding: 0.75rem 1rem;
        border-radius: 10px;
        border: 1px solid #d1d5db;
        font-size: 1rem;
        outline: none;
        transition: 0.2s;
    }

    .form-select:focus {
        border-color: var(--brand-gold);
        box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.25);
    }

    /* Checkbox rows */
    .checkbox-row {
        display: flex;
        align-items: center;
        margin-top: 0.25rem;
    }

    .checkbox {
        border: 1px solid var(--brand-navy);
        border-radius: 0.2rem;
        width: 18px;
        height: 18px;
    }

    .checkbox-label {
        margin-left: 0.6rem;
        font-size: 0.9rem;
        color: #4b5563;
    }

    /* Estimate box */
    .estimate-box {
        border: 1px solid #e5e7eb;
        padding: 1.5rem;
        border-radius: 0.5rem;
    }
    .form-group {
        padding-bottom: 1.5rem;
    }

    .estimate-label {
        font-size: 1.125rem;
        line-height: 1.75rem;
        font-family: "Montserrat-ExtraBold", "Inter", sans-serif;
        color: #6b7280;
        margin: 0;
        padding-bottom: 8px;
        border-bottom: 1px solid #e5e7eb;
    }

    .estimate-price {
        font-size: 2.2rem;
        font-weight: 900;
        font-family: "Montserrat-ExtraBold", "Inter", sans-serif;
        color: var(--brand-navy);
        margin-top: 1.5rem;
    }

    @media (max-width: 640px) {
        .estimate-price {
            font-size: 2rem;
        }
    }

    .estimate-time {
        font-size: 1rem;
        color: #374151;
        margin-top: 0.3rem;
    }

    .estimate-note {
        font-size: 0.75rem;
        color: #6b7280;
        margin-top: 0.4rem;
    }

    /* CTA Button */
    .cta-button {
        width: 100%;
        text-align: center;
        background: var(--brand-gold);
        color: var(--brand-navy);
        border: none;
        padding: 0.9rem 1.5rem;
        font-size: 1rem;
        font-family: "Montserrat-SemiBold", "Inter", sans-serif;
        border-radius: 10px;
        cursor: pointer;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        transition: 0.3s ease;
    }

    .cta-button:hover {
        transform: scale(1.02);
        background: #e8a900;
    }
</style>
